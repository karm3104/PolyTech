<!DOCTYPE html>
<html lang="jp">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>ユーザー認証付き共有ディレクトリの作成</h1>
  <div>
    <h2>linux側で追加</h2>
    <div>
      <h3>条件</h3>
      <p>共有名：kaihatsu_share</p>
      <p>アクセス制限：kaihatsuグループに所属するユーザ</p>
      <p>kaihatsuグループのユーザ:suzuki、 tanaka、 yamamoto</p>
      <br>
      <p>条件</p>
      <p>共有名：system_share</p>
      <p>アクセス制限：systemグループに所属するユーザ</p>
      <p>systemグループのユーザ:yamada、 takahashi、 aoki</p>
      <br>
      <p>条件</p>
      <p>共有名：public</p>
      <p>アクセス制限：kaihatsuとsystemグループのみ</p>
      <p>publicグループのユーザ:yamada、 takahashi、 aoki</p>
    </div>
    <div>
      <h3>ディレクトリの作成</h3>
      <p>対象：kaihatsu_share、system_share、public</p>
      <p>上記それぞれ作成する</p>
      <p class="command">$sudo mkdir /home/xxxx</p>
      <br>
      <h3>パーミッションの設定</h3>
      <p>対象：kaihatsu_share、system_share、public</p>
      <p>上記それぞれ作成する</p>
      <p class="command">$sudo chmod xxx /home/xxxx</p>
      <br>
      <h3>ユーザーの作成</h3>
      <p>対象：suzuki、 tanaka、 yamamoto、yamada、 takahashi、 aoki</p>
      <p>上記それぞれ作成する</p>
      <p class="command">$sudo adduser xxxx</p>
      <br>
      <h3>グループの作成</h3>
      <p>対象：kaihatsu、system、public</p>
      <p>上記それぞれ作成する</p>
      <p class="command">$sudo addgroup xxxx</p>
      <br>
      <h3>作成したグループにそれぞれ所属させる</h3>
      <p>kaihatsuグループのユーザ:suzuki、 tanaka、 yamamoto</p>
      <p>systemグループのユーザ:yamada、 takahashi、 aoki</p>
      <p>上記それぞれ作成する</p>
      <p class="command">$sudo adduser {user} {group}</p><br>
    </div>
  </div>
  <div>
    <h2>sambaユーザーの登録</h2>
    <div>
      <h3>smb.confファイルの編集</h3>
      <p>#80行目付近</p>
      <p>security = user</p>
      <p>passdb backend = yes</p>
      <br>
      <p>#ファイル末尾に追加</p>
      <p>[xxxx_share等ff]</p>
      <p>path = /home/xxxx/</p>
      <p>browseable = yes</p>
      <p>writable = yes</p>
      <p>guest ok = no</p>
      <p>guest only = no</p>
      <p>create mode = 0776等</p>
      <p>directory mode = 0776等</p>
      <p>valid users = <br>
      ユーザー複数の場合：xxxx, yyyy, zzzz<br>
      グループ単位の場合：@{グループ名}</p>
      <br>
    </div>
  </div>
  <div>
    <div class="p_area">
      <h3>pdbeditで登録</h3>
      <p>sambaへユーザーを登録する</p>
      <p class="command">$sudo pdbedit -a {user}</p>
      <p>パスワードを入力</p>
      <p>new password:<br>
      retype new password:</p>
      <p>オプションの意味</p>
      <p>-a ユーザーの新規登録<br>
      -u {user}  ユーザーを指定する</p>
    </div>
  </div>

</body>
</html>